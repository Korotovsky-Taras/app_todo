!function(e){var t={};function o(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="./",o(o.s="./js/index.js")}({"../node_modules/css-loader/index.js??ref--5-1!../node_modules/fast-sass-loader/lib/index.js!./js/app.scss":function(e,t,o){(e.exports=o("../node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,"html, body {\n  padding: 0;\n  margin: 0; }\n\nbody {\n  padding-left: 20px;\n  padding-right: 20px;\n  background-color: tomato;\n  font: 13px/22px Arial, sans-serif;\n  margin: auto; }\n",""])},"../node_modules/css-loader/index.js??ref--5-1!../node_modules/fast-sass-loader/lib/index.js!./js/modules/todoform/todoform.scss":function(e,t,o){(e.exports=o("../node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,".todo-form {\n  position: relative; }\n\n.todo-form__textarea {\n  border: none;\n  outline: none;\n  display: block;\n  font: 16px/24px Arial, sans-serif;\n  padding: 12px 20px;\n  box-sizing: border-box;\n  max-width: 100%;\n  min-width: 100%;\n  margin-bottom: 8px; }\n\n.todo-form__hint {\n  font-size: 11px;\n  float: left; }\n\n.todo-form__select {\n  float: right; }\n",""])},"../node_modules/css-loader/index.js??ref--5-1!../node_modules/fast-sass-loader/lib/index.js!./js/modules/todoitem/todoitem.scss":function(e,t,o){(e.exports=o("../node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,".todo-list__item {\n  background: #fff;\n  padding: 10px 40px 10px 40px;\n  border-radius: 4px;\n  position: relative; }\n  .todo-list__item + .todo-list__item {\n    margin-top: 1px; }\n  .todo-list__item.low {\n    background-color: #fff; }\n  .todo-list__item.middle {\n    background-color: cornsilk; }\n  .todo-list__item.high {\n    background-color: bisque; }\n  .todo-list__item:hover {\n    background-color: antiquewhite; }\n  .todo-list__item.checked {\n    background-color: transparent; }\n    .todo-list__item.checked .todo-list__item-text {\n      text-decoration: line-through; }\n\n.todo-list__item-checkbox {\n  position: absolute;\n  left: 12px;\n  top: 50%;\n  margin: -6px 0 0 0; }\n\n.todo-list__item-close {\n  position: absolute;\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  overflow: hidden;\n  right: 12px;\n  top: 50%;\n  margin-top: -8px; }\n  .todo-list__item-close:hover::before, .todo-list__item-close:hover::after {\n    color: red; }\n  .todo-list__item-close::before, .todo-list__item-close::after {\n    content: '';\n    position: absolute;\n    height: 1px;\n    width: 100%;\n    top: 50%;\n    left: 0;\n    margin-top: -1px;\n    background: #000; }\n  .todo-list__item-close::before {\n    transform: rotate(45deg); }\n  .todo-list__item-close::after {\n    transform: rotate(-45deg); }\n\n.todo-list__item-text {\n  padding: 0;\n  margin: 0;\n  font: inherit; }\n",""])},"../node_modules/css-loader/index.js??ref--5-1!../node_modules/fast-sass-loader/lib/index.js!./js/modules/todolist/todolist.scss":function(e,t,o){(e.exports=o("../node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,".todo-list {\n  padding: 0;\n  margin: 0;\n  font: 14px/24px Arial, sans-serif;\n  list-style-type: none; }\n",""])},"../node_modules/css-loader/index.js??ref--5-1!../node_modules/fast-sass-loader/lib/index.js!./js/modules/todomanager/todomanager.scss":function(e,t,o){(e.exports=o("../node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,".todo-manager {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column; }\n  .todo-manager__header {\n    padding: 20px;\n    background: turquoise; }\n  .todo-manager__body {\n    flex: 1;\n    min-height: 0;\n    overflow-x: hidden;\n    overflow-y: auto;\n    padding: 20px; }\n",""])},"../node_modules/css-loader/lib/css-base.js":function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var o=function(e,t){var o=e[1]||"",s=e[3];if(!s)return o;if(t&&"function"==typeof btoa){var n=(r=s,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),i=s.sources.map(function(e){return"/*# sourceURL="+s.sourceRoot+e+" */"});return[o].concat(i).concat([n]).join("\n")}var r;return[o].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+o+"}":o}).join("")},t.i=function(e,o){"string"==typeof e&&(e=[[null,e,""]]);for(var s={},n=0;n<this.length;n++){var i=this[n][0];"number"==typeof i&&(s[i]=!0)}for(n=0;n<e.length;n++){var r=e[n];"number"==typeof r[0]&&s[r[0]]||(o&&!r[2]?r[2]=o:o&&(r[2]="("+r[2]+") and ("+o+")"),t.push(r))}},t}},"../node_modules/pug-runtime/index.js":function(e,t,o){"use strict";var s=Object.prototype.hasOwnProperty;function n(e,t){return Array.isArray(e)?function(e,t){for(var o,s="",i="",r=Array.isArray(t),a=0;a<e.length;a++)(o=n(e[a]))&&(r&&t[a]&&(o=d(o)),s=s+i+o,i=" ");return s}(e,t):e&&"object"==typeof e?function(e){var t="",o="";for(var n in e)n&&e[n]&&s.call(e,n)&&(t=t+o+n,o=" ");return t}(e):e||""}function i(e){if(!e)return"";if("object"==typeof e){var t="";for(var o in e)s.call(e,o)&&(t=t+o+":"+e[o]+";");return t}return e+""}function r(e,t,o,s){return!1!==t&&null!=t&&(t||"class"!==e&&"style"!==e)?!0===t?" "+(s?e:e+'="'+e+'"'):("function"==typeof t.toJSON&&(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),o||-1===t.indexOf('"'))?(o&&(t=d(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"):""}t.merge=function e(t,o){if(1===arguments.length){for(var s=t[0],n=1;n<t.length;n++)s=e(s,t[n]);return s}for(var r in o)if("class"===r){var a=t[r]||[];t[r]=(Array.isArray(a)?a:[a]).concat(o[r]||[])}else if("style"===r){var a=i(t[r]);a=a&&";"!==a[a.length-1]?a+";":a;var d=i(o[r]);d=d&&";"!==d[d.length-1]?d+";":d,t[r]=a+d}else t[r]=o[r];return t},t.classes=n,t.style=i,t.attr=r,t.attrs=function(e,t){var o="";for(var a in e)if(s.call(e,a)){var d=e[a];if("class"===a){d=n(d),o=r(a,d,!1,t)+o;continue}"style"===a&&(d=i(d)),o+=r(a,d,!1,t)}return o};var a=/["&<>]/;function d(e){var t=""+e,o=a.exec(t);if(!o)return e;var s,n,i,r="";for(s=o.index,n=0;s<t.length;s++){switch(t.charCodeAt(s)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;default:continue}n!==s&&(r+=t.substring(n,s)),n=s+1,r+=i}return n!==s?r+t.substring(n,s):r}t.escape=d,t.rethrow=function e(t,s,n,i){if(!(t instanceof Error))throw t;if(!("undefined"==typeof window&&s||i))throw t.message+=" on line "+n,t;try{i=i||o(0).readFileSync(s,"utf8")}catch(o){e(t,null,n)}var r=3,a=i.split("\n"),d=Math.max(n-r,0),l=Math.min(a.length,n+r);var r=a.slice(d,l).map(function(e,t){var o=t+d+1;return(o==n?"  > ":"    ")+o+"| "+e}).join("\n");t.path=s;t.message=(s||"Pug")+":"+n+"\n"+r+"\n\n"+t.message;throw t}},"../node_modules/style-loader/lib/addStyles.js":function(e,t,o){var s,n,i={},r=(s=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===n&&(n=s.apply(this,arguments)),n}),a=function(e){var t={};return function(e){if("function"==typeof e)return e();if(void 0===t[e]){var o=function(e){return document.querySelector(e)}.call(this,e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}}(),d=null,l=0,c=[],u=o("../node_modules/style-loader/lib/urls.js");function f(e,t){for(var o=0;o<e.length;o++){var s=e[o],n=i[s.id];if(n){n.refs++;for(var r=0;r<n.parts.length;r++)n.parts[r](s.parts[r]);for(;r<s.parts.length;r++)n.parts.push(x(s.parts[r],t))}else{var a=[];for(r=0;r<s.parts.length;r++)a.push(x(s.parts[r],t));i[s.id]={id:s.id,refs:1,parts:a}}}}function h(e,t){for(var o=[],s={},n=0;n<e.length;n++){var i=e[n],r=t.base?i[0]+t.base:i[0],a={css:i[1],media:i[2],sourceMap:i[3]};s[r]?s[r].parts.push(a):o.push(s[r]={id:r,parts:[a]})}return o}function m(e,t){var o=a(e.insertInto);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var s=c[c.length-1];if("top"===e.insertAt)s?s.nextSibling?o.insertBefore(t,s.nextSibling):o.appendChild(t):o.insertBefore(t,o.firstChild),c.push(t);else if("bottom"===e.insertAt)o.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var n=a(e.insertInto+" "+e.insertAt.before);o.insertBefore(t,n)}}function p(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function v(e){var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),g(t,e.attrs),m(e,t),t}function g(e,t){Object.keys(t).forEach(function(o){e.setAttribute(o,t[o])})}function x(e,t){var o,s,n,i;if(t.transform&&e.css){if(!(i=t.transform(e.css)))return function(){};e.css=i}if(t.singleton){var r=l++;o=d||(d=v(t)),s=_.bind(null,o,r,!1),n=_.bind(null,o,r,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(o=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",g(t,e.attrs),m(e,t),t}(t),s=function(e,t,o){var s=o.css,n=o.sourceMap,i=void 0===t.convertToAbsoluteUrls&&n;(t.convertToAbsoluteUrls||i)&&(s=u(s));n&&(s+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var r=new Blob([s],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(r),a&&URL.revokeObjectURL(a)}.bind(null,o,t),n=function(){p(o),o.href&&URL.revokeObjectURL(o.href)}):(o=v(t),s=function(e,t){var o=t.css,s=t.media;s&&e.setAttribute("media",s);if(e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}.bind(null,o),n=function(){p(o)});return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else n()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=r()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var o=h(e,t);return f(o,t),function(e){for(var s=[],n=0;n<o.length;n++){var r=o[n];(a=i[r.id]).refs--,s.push(a)}e&&f(h(e,t),t);for(n=0;n<s.length;n++){var a;if(0===(a=s[n]).refs){for(var d=0;d<a.parts.length;d++)a.parts[d]();delete i[a.id]}}}};var b,y=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function _(e,t,o,s){var n=o?"":s.css;if(e.styleSheet)e.styleSheet.cssText=y(t,n);else{var i=document.createTextNode(n),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(i,r[t]):e.appendChild(i)}}},"../node_modules/style-loader/lib/urls.js":function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var o=t.protocol+"//"+t.host,s=o+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var n,i=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(n=0===i.indexOf("//")?i:0===i.indexOf("/")?o+i:s+i.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")})}},"./js/app.scss":function(e,t,o){var s=o("../node_modules/css-loader/index.js??ref--5-1!../node_modules/fast-sass-loader/lib/index.js!./js/app.scss");"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};o("../node_modules/style-loader/lib/addStyles.js")(s,n);s.locals&&(e.exports=s.locals)},"./js/index.js":function(e,t,o){"use strict";o.r(t);o("./js/app.scss"),o("./js/modules/todomanager/todomanager.scss");class s{constructor(e,t=!1){this.el=document.createElement("div"),this.elements={},this.prepend=t,this.initElement=e}init(e=null){e&&(this.el.innerHTML=e,this.el=this.el.children[0]),this.prepend?this.initElement.prepend(this.el):this.initElement.append(this.el),this.onAttach(this.el)}deffineElement(e,t,o="div"){let s=this.getElement(t);return s||(s=this.createElement(t,o)),s.classList.add(e+"__"+t),s}createElement(e,t="div"){let o=document.createElement(t);return this.elements[e]=o,o}getElement(e){if(this.elements.hasOwnProperty(e))return this.elements[e]}get view(){return this.el}onAttach(){}}o("./js/modules/todolist/todolist.scss"),o("./js/modules/todoitem/todoitem.scss");var n=o("./js/modules/todoitem/todoitem.pug"),i=o.n(n);class r extends s{constructor(e,{text:t,checked:o=!1,priority:{value:s,selector:n},id:r,ondatachange:a}){super(e,!0),this.text=t,this.data={text:t,checked:o,priority:{value:s,selector:n}},this.id=r,this.prioritySelector=n,this.ondatachange=a,this.init(i()({text:t}))}onAttach(e){e.classList.add(this.prioritySelector),this.loadCheckbox(),this.loadCloseButton()}loadCloseButton(){this.view.querySelector(".todo-list__item-close").addEventListener("click",()=>{this.view.remove(),this.onRemove()})}loadCheckbox(){let e=this.view.querySelector(".todo-list__item-checkbox"),t=t=>{this.view.classList.toggle("checked",t),t&&(e.checked=!0)};t(this.data.checked),e.addEventListener("change",()=>{let o=e.checked;this.data.checked=o,t(o),this.onCheckbox()})}onRemove(){this.ondatachange("onRemove",{id:this.id})}onCheckbox(){this.ondatachange("onChange",{id:this.id,key:"checked",value:this.data.checked})}}class a extends s{constructor(e,t){super(e),this.id=-1,this.model=t,this.procedures=t.procedures,this.className="todo-list",this.init()}onAttach(e){e.classList.add(this.className),this.loadItems()}loadItems(){let e=this.model.storage;if(e&&e instanceof Array)for(let{data:t}of e)this.addItem(t)}addItem(e){this.model.push(new r(this.view,Object.assign(e,{id:++this.id,ondatachange:(...e)=>{this.onDataChange(...e)}})))}onDataChange(e,...t){this.procedures[e](...t)}}o("./js/modules/todoform/todoform.scss");class d extends s{constructor(e){super(e),this.className="todo-form",this.init()}onAttach(e){e.classList.add(this.className),this.createTextarea(),this.createSelect(),this.createHint()}createHint(){let e=this.deffineElement(this.className,"hint");e.innerHTML="Use Ctrl+Enter to create todo-item",this.view.appendChild(e)}createSelect(){let e=e=>{let t=document.createElement("option");return t.text=e,t},t=this.deffineElement(this.className,"select","select");for(let o of["low","middle","high"])t.add(e(o));this.view.appendChild(t)}createTextarea(){let e=this.deffineElement(this.className,"textarea","textarea");this.view.appendChild(e),e.addEventListener("keyup",e=>{e.ctrlKey&&13===e.keyCode&&this.send()})}send(){let e=this.getElement("textarea"),t=this.getElement("select"),{selectedIndex:o}=t.options,s=e.value;""!==s.trim()&&(e.value="",e.focus(),t.options.selectedIndex=0,this.insertMessage({text:s,priority:{value:o,selector:t.options[o].innerText}}))}insertMessage(e){}}const l="todo";class c{constructor(){this.map=[],this.procedures={onRemove:({id:e})=>{this.remove(e)},onChange:({id:e,key:t,value:o})=>{this.change(e,t,o)},onAdd:({data:e})=>{this.push(e)}}}get storage(){let e=localStorage.getItem(l);return e?JSON.parse(e):null}save(){localStorage.setItem(l,JSON.stringify(this.map))}push(e){this.map.push(e),this.save()}change(e,t,o){console.log(this.map,this.map[e],e,t,o),this.map[e][t]=o,this.save()}remove(e){this.map.splice(e,1),this.save()}}window.addEventListener("DOMContentLoaded",()=>{new class extends s{constructor(e){super(e),this.className="todo-manager",this.model=new c,this.init()}onAttach(e){let t=this.deffineElement(this.className,"header"),o=this.deffineElement(this.className,"body");e.classList.add(this.className),e.appendChild(t),e.appendChild(o);let s=new a(o,this.model);new d(t).insertMessage=(e=>{s.addItem(e)}),s.onChange=(e=>{console.log(e)})}}(document.body)})},"./js/modules/todoform/todoform.scss":function(e,t,o){var s=o("../node_modules/css-loader/index.js??ref--5-1!../node_modules/fast-sass-loader/lib/index.js!./js/modules/todoform/todoform.scss");"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};o("../node_modules/style-loader/lib/addStyles.js")(s,n);s.locals&&(e.exports=s.locals)},"./js/modules/todoitem/todoitem.pug":function(e,t,o){var s=o("../node_modules/pug-runtime/index.js");e.exports=function(e){var t,o="",n=e||{};return function(e){o=o+'<div class="todo-list__item"><pre class="todo-list__item-text">'+s.escape(null==(t=e)?"":t)+'</pre><span class="todo-list__item-close"></span><input class="todo-list__item-checkbox" type="checkbox"></div>'}.call(this,"text"in n?n.text:"undefined"!=typeof text?text:void 0),o}},"./js/modules/todoitem/todoitem.scss":function(e,t,o){var s=o("../node_modules/css-loader/index.js??ref--5-1!../node_modules/fast-sass-loader/lib/index.js!./js/modules/todoitem/todoitem.scss");"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};o("../node_modules/style-loader/lib/addStyles.js")(s,n);s.locals&&(e.exports=s.locals)},"./js/modules/todolist/todolist.scss":function(e,t,o){var s=o("../node_modules/css-loader/index.js??ref--5-1!../node_modules/fast-sass-loader/lib/index.js!./js/modules/todolist/todolist.scss");"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};o("../node_modules/style-loader/lib/addStyles.js")(s,n);s.locals&&(e.exports=s.locals)},"./js/modules/todomanager/todomanager.scss":function(e,t,o){var s=o("../node_modules/css-loader/index.js??ref--5-1!../node_modules/fast-sass-loader/lib/index.js!./js/modules/todomanager/todomanager.scss");"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};o("../node_modules/style-loader/lib/addStyles.js")(s,n);s.locals&&(e.exports=s.locals)},0:function(e,t){}});
//# sourceMappingURL=main.js.map